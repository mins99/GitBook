# 아이템5 - 자원을 직접 명시하지 말고 의존 객체 주입을 사용하라

### **의존 객체 주입(Dependency Injection)**

* 클래스가 내부적으로 하나 이상의 자원에 의존하고, 그 자원이 클래스 동작에 영향을 준다면 싱글턴과 정적 유틸리티 클래스는 사용하지 않는 것이 좋다
* 인스턴스를 생성할 때 필요한 자원(혹은 자원을 생성하는 팩터리)을 **생성자**(혹은 정적 팩터리나 빌더에) 넘겨주자

```java
public class SpellChecker {
    private final Lexicon dictionary;
    
    public SpellChecker(Lexicon dictionary) {
        this.dictionary = Objects.requireNonNull(dictionary);
    }
}
```

### Spring의 DI

어노테이션을 통해 스프링 빈을 등록하게 되면

→ 스프링에서 인스턴스를 생성 및 관리하며

→ 의존성이 필요한 부분이 생기는 경우 자동으로 해당 인스턴스를 주입해준다

### Spring의 DI를 통한 자동 주입(@Autowired) 사용법

1. 필드 주입

* 장점 : 간단하다
* 단점 : 수동 의존성 주입이 불가. 추천하지 않음

2\. setter 주입

* 장점 : 런타임 시점에 의존 객체를 변경 가능하다
* 단점 : 빈 생성자 또는 빈 정적 팩토리 메서드가 필요하다. 즉, 주입 대상 객체를 final로 선언 할 수 없다.

3\. 생성자 주입

* 장점 : 객체 생성 시점에 의존성을 주입하여 final로 선언 가능

→ 의존성 주입 순서는 생성자 -> 필드 -> setter 순

### Spring에서 DI 방법으로 생성자 주입을 추천하는 이유?

* 필드 주입이나 setter 주입은 스프링의 빈 관리 기능을 빌리는 것이 아님 → NPE 발생 가능성이 있음
* 생성자 주입은 스프링에서 관리하는 빈 객체를 주입하는 방식이라 NPE 발생이 없음(완전하다는 가정!)
*   생성자 주입을 사용하면 순환 참조 이슈를 어플리케이션 로드 시점에 알 수 있다

    → 참고로 스프링 부트 2.6부터는 모든 주입 방식에 대해 순환 참조 이슈를 알 수 있다
